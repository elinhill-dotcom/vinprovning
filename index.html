<!doctype html>
<html lang="sv" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
  <title>Vinprovning p√• slalomgr√§nd</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&amp;family=Lato:wght@300;400;500&amp;display=swap" rel="stylesheet">
  <style>
    html, body {
      height: 100%;
      width: 100%;
    }

    .font-display { font-family: 'Playfair Display', Georgia, serif; }
    .font-body { font-family: 'Lato', system-ui, sans-serif; }

    .wine-gradient {
      background: linear-gradient(135deg, #8b1e3f 0%, #4a0f25 100%);
    }

    .card-light {
      background: #f4efe7;
    }

    .accent-deep {
      color: #8b1e3f;
    }

    .accent-light {
      color: #f4efe7;
    }

    .wine-card {
      transition: all 0.3s ease;
      cursor: pointer;
      border-left: 4px solid #8b1e3f;
      -webkit-tap-highlight-color: transparent;
    }

    .wine-card:active {
      transform: scale(0.98);
    }

    .wine-card.active {
      background: #fff5f0;
      border-left: 4px solid #f4efe7;
    }

    .btn-primary {
      background: #8b1e3f;
      color: #f4efe7;
      -webkit-tap-highlight-color: transparent;
      min-height: 48px;
      font-size: 16px;
    }

    .btn-primary:active {
      background: #6a1630;
    }

    .option-btn {
      border: 2px solid #ddd;
      transition: all 0.2s;
      -webkit-tap-highlight-color: transparent;
      min-height: 48px;
      font-size: 16px;
      font-weight: 500;
      padding: 12px 8px;
      touch-action: manipulation;
    }

    .option-btn:active {
      transform: scale(0.95);
    }

    .option-btn.selected {
      background: #8b1e3f;
      color: #f4efe7;
      border-color: #8b1e3f;
    }

    .quiz-option-btn {
      border: 2px solid #ddd;
      transition: all 0.2s;
      -webkit-tap-highlight-color: transparent;
      min-height: 48px;
      font-size: 15px;
      font-weight: 500;
      padding: 12px;
      touch-action: manipulation;
      cursor: pointer;
    }

    .quiz-option-btn:active {
      transform: scale(0.98);
    }

    .quiz-option-btn.selected {
      background: #8b1e3f;
      color: #f4efe7;
      border-color: #8b1e3f;
    }

    .quiz-option-btn.correct {
      background: #10b981;
      color: white;
      border-color: #10b981;
    }

    .quiz-option-btn.incorrect {
      background: #ef4444;
      color: white;
      border-color: #ef4444;
    }

    .star-btn {
      -webkit-tap-highlight-color: transparent;
      min-width: 48px;
      min-height: 48px;
      font-size: 32px;
      padding: 4px;
      touch-action: manipulation;
    }

    .star-btn:active {
      transform: scale(1.1);
    }

    .star-rating {
      color: #8b1e3f;
    }

    input, textarea, select {
      font-size: 16px;
      -webkit-appearance: none;
      appearance: none;
      border-radius: 8px;
    }

    input[type="text"], textarea, select {
      padding: 14px 16px;
      min-height: 48px;
    }

    textarea {
      resize: vertical;
      min-height: 100px;
    }

    select {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%238b1e3f' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 12px center;
      padding-right: 36px;
    }

    .result-card {
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .result-card:active {
      transform: scale(0.98);
    }

    @keyframes slalom {
      0% { transform: translateX(-25px) rotateZ(-20deg); }
      25% { transform: translateX(20px) rotateZ(20deg); }
      50% { transform: translateX(-20px) rotateZ(-20deg); }
      75% { transform: translateX(25px) rotateZ(20deg); }
      100% { transform: translateX(-25px) rotateZ(-20deg); }
    }

    .slalom-bottle {
      animation: slalom 3.5s ease-in-out infinite;
      transform-origin: center;
    }

    @keyframes podium-rise {
      0% { transform: scaleY(0); opacity: 0; }
      100% { transform: scaleY(1); opacity: 1; }
    }

    .podium-gold {
      animation: podium-rise 0.6s ease-out 0.2s both;
      background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
      transform-origin: bottom;
    }

    .podium-silver {
      animation: podium-rise 0.6s ease-out 0.4s both;
      background: linear-gradient(135deg, #d1d5db 0%, #9ca3af 100%);
      transform-origin: bottom;
    }

    .podium-bronze {
      animation: podium-rise 0.6s ease-out 0.6s both;
      background: linear-gradient(135deg, #fb923c 0%, #f97316 100%);
      transform-origin: bottom;
    }

    .podium-position {
      color: white;
      font-weight: bold;
      font-size: 24px;
    }

    @media (max-width: 640px) {
      .max-w-6xl {
        max-width: 100%;
      }

      .p-8 {
        padding: 16px;
      }

      .p-4 {
        padding: 12px;
      }

      .gap-4 {
        gap: 12px;
      }

      .grid {
        gap: 12px;
      }
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .slide-in {
      animation: slideIn 0.4s ease-out;
    }

    .reset-confirm {
      background: #dc2626;
    }

    .reset-confirm:hover {
      background: #991b1b;
    }
  </style>
  <style>body { box-sizing: border-box; }</style>
 </head>
 <body class="h-full font-body">
  <div id="app" class="h-full w-full wine-gradient overflow-auto">
   <div class="w-full min-h-full p-4 pb-20"><!-- Header -->
    <header class="text-center mb-6">
     <div class="flex items-center justify-center gap-3 mb-3 flex-wrap">
      <svg width="70" height="70" viewbox="0 0 120 140" xmlns="http://www.w3.org/2000/svg" class="slalom-bottle flex-shrink-0"><g>
        <rect x="5" y="88" width="35" height="3" fill="#dd0000" rx="1" />
        <rect x="6" y="91" width="33" height="2" fill="#222" />
        <rect x="18" y="85" width="10" height="8" fill="#333" opacity="0.6" />
        <circle cx="20" cy="89" r="1.5" fill="#999" />
        <circle cx="26" cy="89" r="1.5" fill="#999" />
       </g> <g>
        <rect x="80" y="88" width="35" height="3" fill="#dd0000" rx="1" />
        <rect x="81" y="91" width="33" height="2" fill="#222" />
        <rect x="92" y="85" width="10" height="8" fill="#333" opacity="0.6" />
        <circle cx="94" cy="89" r="1.5" fill="#999" />
        <circle cx="100" cy="89" r="1.5" fill="#999" />
       </g> <rect x="57" y="15" width="6" height="12" fill="#1a3d0a" /> <rect x="56" y="10" width="8" height="4" fill="#d4af37" rx="1" /> <ellipse cx="60" cy="10" rx="4" ry="2" fill="#ffd700" /> <ellipse cx="60" cy="32" rx="13" ry="14" fill="#2d5016" /> <rect x="51" y="42" width="18" height="38" fill="#1a3d0a" rx="2" /> <rect x="52" y="48" width="16" height="28" fill="#722f37" rx="1" /> <ellipse cx="54" cy="38" rx="3" ry="8" fill="rgba(255,255,255,0.3)" />
      </svg>
      <h1 id="event-title" class="font-display text-2xl sm:text-4xl font-bold accent-light">Vinprovning p√• slalomgr√§nd</h1>
     </div>
     <p class="accent-light text-base opacity-90">Hitta √•rets b√§sta vin</p>
    </header>
    <div class="w-full"><!-- Navigation -->
     <div class="flex justify-center gap-2 mb-6 flex-wrap"><button id="btn-setup" onclick="showSetup()" class="px-4 py-2 sm:px-6 sm:py-2 rounded-full btn-primary transition-all text-sm sm:text-base"> ‚öôÔ∏è Inst. </button> <button id="btn-vote" onclick="showVoting()" class="px-4 py-2 sm:px-6 sm:py-2 rounded-full bg-white/20 accent-light transition-all text-sm sm:text-base"> üó≥Ô∏è R√∂sta </button> <button id="btn-wine-results" onclick="showWineResults()" class="px-4 py-2 sm:px-6 sm:py-2 rounded-full bg-white/20 accent-light transition-all text-sm sm:text-base"> üç∑ Resultat </button> <button id="btn-quiz" onclick="showQuiz()" class="px-4 py-2 sm:px-6 sm:py-2 rounded-full bg-white/20 accent-light transition-all text-sm sm:text-base"> üß† Quiz </button> <button id="btn-quiz-results" onclick="showQuizResults()" class="px-4 py-2 sm:px-6 sm:py-2 rounded-full bg-white/20 accent-light transition-all text-sm sm:text-base"> üèÜ Topplista </button>
     </div><!-- Setup Section -->
     <div id="setup-section" class="card-light rounded-xl shadow-xl p-4 sm:p-6 slide-in">
      <h2 class="font-display text-2xl font-bold accent-deep mb-4">L√§gg till viner</h2>
      <form id="wine-form" onsubmit="handleAddWine(event)">
       <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 mb-4">
        <div><label class="block text-xs font-semibold accent-deep mb-2">Vinnummer *</label> <input type="text" id="wine_number" required placeholder="t.ex. 1, A2, R√∂d" class="w-full rounded-lg border border-gray-300">
        </div>
        <div><label class="block text-xs font-semibold accent-deep mb-2">Land *</label> <input type="text" id="country" required placeholder="Frankrike" class="w-full rounded-lg border border-gray-300">
        </div>
        <div><label class="block text-xs font-semibold accent-deep mb-2">Druva *</label> <input type="text" id="grape" required placeholder="Pinot Noir" class="w-full rounded-lg border border-gray-300">
        </div>
        <div><label class="block text-xs font-semibold accent-deep mb-2">Pris</label> <input type="text" id="price" placeholder="250 kr" class="w-full rounded-lg border border-gray-300">
        </div>
       </div><button type="submit" class="w-full btn-primary rounded-lg font-semibold transition-all"> ‚ûï L√§gg till vin </button>
      </form>
      <div class="mt-6">
       <h3 class="font-display text-lg font-bold accent-deep mb-3">Registrerade viner</h3>
       <div id="wines-list" class="space-y-2"><!-- Wines will be listed here -->
       </div>
      </div>
      <hr class="my-6 border-gray-300">
      <div>
       <h3 class="font-display text-lg font-bold accent-deep mb-4">Deltagare</h3>
       <form id="participant-form" onsubmit="handleAddParticipant(event)">
        <div class="flex gap-2 mb-4"><input type="text" id="participant_name" required placeholder="Namn" class="flex-1 rounded-lg border border-gray-300"> <button type="submit" class="btn-primary px-4 py-3 sm:px-6 rounded-lg font-semibold transition-all min-h-[48px]"> ‚ûï </button>
        </div>
       </form>
       <div id="participants-list" class="grid grid-cols-2 sm:grid-cols-3 gap-2"><!-- Participants will be listed here -->
       </div>
      </div>
      <hr class="my-6 border-gray-300">
      <div>
       <h3 class="font-display text-lg font-bold accent-deep mb-4">√Öterst√§ll</h3><button id="reset-quiz-btn" onclick="confirmResetQuiz()" class="w-full px-4 py-3 bg-red-600 text-white rounded-lg font-semibold transition-all min-h-[48px]"> üîÑ √Öterst√§ll Quiz </button>
       <p class="text-xs text-gray-600 mt-2">Tar bort alla quizresultat</p>
      </div>
     </div><!-- Voting Section -->
     <div id="voting-section" class="hidden slide-in">
      <div class="card-light rounded-xl shadow-xl p-4 sm:p-6 mb-4">
       <div class="mb-4"><label class="block text-xs font-semibold accent-deep mb-2">V√§lj deltagare *</label> <select id="voter-select" onchange="selectVoter()" class="w-full rounded-lg border border-gray-300"> <option value="">-- V√§lj deltagare --</option> </select>
       </div>
       <div id="wines-voting" class="space-y-3"><!-- Wine voting cards will be listed here -->
       </div>
      </div>
     </div><!-- Wine Results Section -->
     <div id="wine-results-section" class="hidden slide-in">
      <div class="card-light rounded-xl shadow-xl p-4 sm:p-6">
       <h2 class="font-display text-3xl font-bold accent-deep mb-6 text-center">üç∑ Vinprovning - Resultat</h2>
       <div id="wine-results-content" class="space-y-4"><!-- Wine results will be displayed here -->
       </div>
      </div>
     </div><!-- Quiz Section -->
     <div id="quiz-section" class="hidden slide-in">
      <div class="card-light rounded-xl shadow-xl p-4 sm:p-6 mb-4">
       <div id="quiz-start-screen">
        <h2 class="font-display text-2xl font-bold accent-deep mb-4">üß† Vinkunnighetens Quiz</h2>
        <p class="text-gray-600 mb-4">V√§lj ditt namn och testa din vinkompetens!</p><label class="block text-xs font-semibold accent-deep mb-2">V√§lj deltagare *</label> <select id="quiz-participant-select" class="w-full rounded-lg border border-gray-300 mb-4"> <option value="">-- V√§lj ditt namn --</option> </select> <button onclick="startQuiz()" class="w-full btn-primary rounded-lg font-semibold transition-all"> B√∂rja Quiz </button>
       </div>
       <div id="quiz-questions-screen" class="hidden">
        <div class="mb-4">
         <p class="font-semibold accent-deep text-center mb-3 text-lg" id="quiz-participant-name"></p>
         <div class="flex justify-between items-center mb-2">
          <p class="font-semibold accent-deep" id="quiz-question-number">Fr√•ga 1 av 15</p>
          <div class="bg-white px-3 py-1 rounded-full text-sm font-semibold accent-deep"><span id="quiz-score">0</span>/15
          </div>
         </div>
         <div class="w-full bg-gray-200 rounded-full h-2">
          <div id="quiz-progress-bar" class="bg-8b1e3f h-2 rounded-full transition-all" style="width: 0%; background-color: #8b1e3f;"></div>
         </div>
        </div>
        <div id="quiz-question-container" class="space-y-4"><!-- Questions will be rendered here -->
        </div>
       </div>
      </div>
     </div><!-- Quiz Results Section -->
     <div id="quiz-results-section" class="hidden slide-in">
      <div class="card-light rounded-xl shadow-xl p-4 sm:p-6">
       <h2 class="font-display text-3xl font-bold accent-deep mb-6 text-center">üèÜ Quiz - Topplista</h2>
       <div id="quiz-results-content" class="space-y-4"><!-- Quiz results will be displayed here -->
       </div>
       <div id="quiz-detail-modal" class="hidden fixed inset-0 bg-black/50 flex items-end sm:items-center justify-center z-50 p-0 sm:p-4">
        <div class="card-light rounded-t-2xl sm:rounded-2xl shadow-2xl w-full sm:max-w-2xl max-h-[90vh] overflow-y-auto p-4 sm:p-8">
         <div class="flex justify-between items-start mb-6">
          <h3 id="quiz-detail-title" class="font-display text-2xl font-bold accent-deep">Quiz svar</h3><button type="button" onclick="closeQuizDetailModal()" class="text-2xl">‚úï</button>
         </div>
         <div id="quiz-detail-answers" class="space-y-4"><!-- Answers will be displayed here -->
         </div><button type="button" onclick="closeQuizDetailModal()" class="w-full btn-primary rounded-lg font-semibold transition-all mt-6"> ‚úï St√§ng </button>
        </div>
       </div>
      </div>
     </div><!-- Wine Rating Modal -->
     <div id="rating-modal" class="hidden fixed inset-0 bg-black/50 flex items-end sm:items-center justify-center z-50 p-0 sm:p-4">
      <div class="card-light rounded-t-2xl sm:rounded-2xl shadow-2xl w-full sm:max-w-2xl max-h-[90vh] overflow-y-auto p-4 sm:p-8">
       <h2 id="modal-wine-title" class="font-display text-2xl font-bold accent-deep mb-1">Vin</h2>
       <p id="modal-wine-info" class="text-gray-600 mb-6 text-sm"></p>
       <form id="rating-form" onsubmit="handleSubmitRating(event)">
        <div class="space-y-4">
         <div><label class="block text-sm font-semibold accent-deep mb-2">Aroma</label>
          <div class="flex gap-2"><button type="button" class="option-btn flex-1 rounded-lg" onclick="selectOption(this, 'aroma', 'L√•g')">L√•g</button> <button type="button" class="option-btn flex-1 rounded-lg" onclick="selectOption(this, 'aroma', 'Medel')">Medel</button> <button type="button" class="option-btn flex-1 rounded-lg" onclick="selectOption(this, 'aroma', 'H√∂g')">H√∂g</button>
          </div>
         </div>
         <div><label class="block text-sm font-semibold accent-deep mb-2">Fyllighet</label>
          <div class="flex gap-2"><button type="button" class="option-btn flex-1 rounded-lg" onclick="selectOption(this, 'fullness', 'L√§tt')">L√§tt</button> <button type="button" class="option-btn flex-1 rounded-lg" onclick="selectOption(this, 'fullness', 'Medium')">Medium</button> <button type="button" class="option-btn flex-1 rounded-lg" onclick="selectOption(this, 'fullness', 'Fyllig')">Fyllig</button>
          </div>
         </div>
         <div><label class="block text-sm font-semibold accent-deep mb-2">Syra</label>
          <div class="flex gap-2"><button type="button" class="option-btn flex-1 rounded-lg" onclick="selectOption(this, 'acidity', 'L√•g')">L√•g</button> <button type="button" class="option-btn flex-1 rounded-lg" onclick="selectOption(this, 'acidity', 'Medel')">Medel</button> <button type="button" class="option-btn flex-1 rounded-lg" onclick="selectOption(this, 'acidity', 'H√∂g')">H√∂g</button>
          </div>
         </div>
         <div><label class="block text-sm font-semibold accent-deep mb-2">S√∂tma</label>
          <div class="flex gap-2"><button type="button" class="option-btn flex-1 rounded-lg" onclick="selectOption(this, 'sweetness', 'Torr')">Torr</button> <button type="button" class="option-btn flex-1 rounded-lg" onclick="selectOption(this, 'sweetness', 'Halvtorr')">Halvtorr</button> <button type="button" class="option-btn flex-1 rounded-lg" onclick="selectOption(this, 'sweetness', 'S√∂t')">S√∂t</button>
          </div>
         </div>
         <div><label class="block text-sm font-semibold accent-deep mb-2">Betyg</label>
          <div id="star-container" class="flex justify-center gap-1"><button type="button" class="star-btn" onclick="setRating(1)">‚òÜ</button> <button type="button" class="star-btn" onclick="setRating(2)">‚òÜ</button> <button type="button" class="star-btn" onclick="setRating(3)">‚òÜ</button> <button type="button" class="star-btn" onclick="setRating(4)">‚òÜ</button> <button type="button" class="star-btn" onclick="setRating(5)">‚òÜ</button>
          </div>
         </div>
         <div><label class="block text-sm font-semibold accent-deep mb-2">K√∂pa igen?</label>
          <div class="flex gap-2"><button type="button" class="option-btn flex-1 rounded-lg" onclick="selectOption(this, 'repurchase', 'Ja')">Ja</button> <button type="button" class="option-btn flex-1 rounded-lg" onclick="selectOption(this, 'repurchase', 'Kanske')">Kanske</button> <button type="button" class="option-btn flex-1 rounded-lg" onclick="selectOption(this, 'repurchase', 'Nej')">Nej</button>
          </div>
         </div>
         <div><label class="block text-sm font-semibold accent-deep mb-2">Noteringar</label> <textarea id="notes" placeholder="Anteckningar..." class="w-full rounded-lg border border-gray-300"></textarea>
         </div>
        </div>
        <div class="flex gap-2 mt-6"><button type="submit" class="flex-1 btn-primary rounded-lg font-semibold transition-all"> ‚úì Spara </button> <button type="button" onclick="closeRatingModal()" class="flex-1 px-4 py-3 bg-gray-300 text-gray-700 rounded-lg font-semibold transition-all"> ‚úï St√§ng </button>
        </div>
       </form>
      </div>
     </div><!-- Wine Details Modal -->
     <div id="details-modal" class="hidden fixed inset-0 bg-black/50 flex items-end sm:items-center justify-center z-50 p-0 sm:p-4">
      <div class="card-light rounded-t-2xl sm:rounded-2xl shadow-2xl w-full sm:max-w-4xl max-h-[90vh] overflow-y-auto p-4 sm:p-8">
       <div class="flex justify-between items-start mb-4">
        <div>
         <h2 id="details-wine-title" class="font-display text-2xl font-bold accent-deep mb-1">Vin</h2>
         <p id="details-wine-info" class="text-gray-600 text-sm"></p>
        </div><button type="button" onclick="closeDetailsModal()" class="text-2xl">‚úï</button>
       </div>
       <div id="details-content" class="space-y-6"><!-- Wine details will be displayed here -->
       </div><button type="button" onclick="closeDetailsModal()" class="w-full btn-primary rounded-lg font-semibold transition-all mt-6"> ‚úï St√§ng </button>
      </div>
     </div>
    </div><!-- Toast -->
    <div id="toast" class="fixed bottom-4 left-4 right-4 sm:left-auto sm:right-auto sm:bottom-4 sm:left-1/2 sm:-translate-x-1/2 px-6 py-3 bg-green-600 text-white rounded-full shadow-lg opacity-0 transition-all duration-300 pointer-events-none z-40">
     Sparad!
    </div>
   </div>
  </div>
  
  <!--
    ‚úÖ N√ÑSTA STEG (VIKTIGT):
    Den h√§r filen √§r f√∂rberedd f√∂r Firebase realtime. F√∂r att allt ska fungera beh√∂ver du √§ven:
      1) Ta bort ALLA f√∂rekomster av window.dataSdk.* i din JS
      2) Ers√§tta med window.__db.* enligt:
         - window.dataSdk.create(x)  -> window.__db.createItem({type: "...", ...x})
         - window.dataSdk.update(x)  -> window.__db.updateItem(existing, patch)
         - window.dataSdk.delete(x)  -> window.__db.deleteItem(existing)
      3) Ta bort Canva init-blocket som k√∂r window.dataSdk.init(...) och beh√•ll bara showSetup();
    Om du vill s√• kan du klistra in din fulla JS (hela scriptet fr√•n Canva) h√§r under och sedan g√∂ra s√∂k/ers√§tt.
  -->

  <!-- FIREBASE REALTIME LAYER (added) -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import {
      getFirestore, collection, addDoc, setDoc, doc, deleteDoc, onSnapshot, query
    } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
    import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

    // TODO: Fyll i fr√•n Firebase Console ‚Üí Project settings ‚Üí Web app
    const firebaseConfig = {
      apiKey: "AIzaSyAVEdU2uNKw9bm4FFdXdPPQvcO5vw6bkrM",
      authDomain: "vinprovning-3cd60.firebaseapp.com",
      projectId: "vinprovning-3cd60",
      storageBucket: "vinprovning-3cd60.firebasestorage.app",
      messagingSenderId: "408622400735",
      appId: "1:408622400735:web:6e04a1d0bb3ee7ddde556a"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Anonymous auth (rekommenderat f√∂r rules)
    const auth = getAuth(app);
    try { await signInAnonymously(auth); } catch (e) { console.warn("Auth error:", e); }

    // Alla som √∂ppnar samma l√§nk med samma ?event= delar data
    const eventId = new URLSearchParams(location.search).get("event") || "slalomgrand";
    const itemsRef = collection(db, "events", eventId, "items");

    async function createItem(payload) {
      await addDoc(itemsRef, payload);
      return { isOk: true };
    }
    async function updateItem(existing, patch) {
      await setDoc(doc(itemsRef, existing.__backendId), { ...existing, ...patch }, { merge: true });
      return { isOk: true };
    }
    async function deleteItem(existing) {
      await deleteDoc(doc(itemsRef, existing.__backendId));
      return { isOk: true };
    }

    window.__db = { createItem, updateItem, deleteItem };

    // Realtime stream ‚Üí anropa befintlig dataHandler.onDataChanged
    onSnapshot(query(itemsRef), (snap) => {
      const data = snap.docs.map(d => ({ __backendId: d.id, ...d.data() }));
      if (window.dataHandler && typeof window.dataHandler.onDataChanged === "function") {
        window.dataHandler.onDataChanged(data);
      } else if (typeof dataHandler?.onDataChanged === "function") {
        dataHandler.onDataChanged(data);
      }
    });
  </script>

  <script>
    const quizQuestions = [
      {
        id: 1,
        question: "Vilket land producerar mest vin i v√§rlden (totalt antal liter, ungef√§rligt snitt √•r)?",
        options: { "1": "Spanien", "X": "Italien", "2": "Frankrike" },
        correct: "X"
      }
      /* ... (RESTEN AV DINA QUIZFR√ÖGOR LIGGER KVAR I ORIGINALFILEN) ... */
    ];
  </script>
 </body>
</html>
